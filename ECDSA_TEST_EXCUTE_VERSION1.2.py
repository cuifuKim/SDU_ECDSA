#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
#赋初值
a = 2
b = 2
p = 17
m = 'hello'
m_1="world"
G = [5, 1]
n = 19
k=2
d = 5
P = Multiply(d, G)#计算公钥
#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
# 测试签名和验证
print("1.测试签名和验证算法---------------------------------------------")
r,s=Ecdsa_Sign(m,n,G,d,k)
print("签名为:",r,s)
print("验证结果为：")
Ecdsa_Verify(m,n,G,r,s,P)
print("#------------------------------------------------------------#")
#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
# 泄露k导致密钥泄露
print("2.泄露k导致密钥泄露---------------------------------------------")
if (d == k_Leaking(r,n,k,s,m)):
    print("验证成功")
print("#------------------------------------------------------------#")
#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
#3 重用k导致密钥泄露
print("3.重用k导致密钥泄露---------------------------------------------")
r_1,s_1=Ecdsa_Sign(m_1,n,G,d,k)
r_2,s_2=Ecdsa_Sign(m,n,G,7,k)
if (d == k_Reuse(r,s,m,r_1,s_1,m_1,n)):
    print("验证成功")
print("#------------------------------------------------------------#")
#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
# 使用相同k，可互相计算密钥
print("4. 使用相同k，互相计算密钥---------------------------------------------")
print("验证结果为：")
Use_the_Same_k(s_1,m_1,s_2,m,r,5,7,n)
print("#------------------------------------------------------------#")
#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
#  r,-s同样为有效签名
print("5. 测试 r,-s是否为有效签名---------------------------------------------")
print("测试结果为：")
Ecdsa_Verify(m,n,G,r,-s,P)
print("#------------------------------------------------------------#")
#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
# 伪装中本聪
print("6. 伪装中本聪---------------------------------------------")
print("伪装是否成功：")
Pretend(r,s,n,G,P)
print("#------------------------------------------------------------#")
#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
# Schnorr_Sign签名、ecdsa签名使用相同的d，k，导致密钥泄露
print("6. Schnorr_Sign签名、ecdsa签名使用相同的d，k，导致密钥泄露---------------------------------------------")
r3,s3=Schnorr_Sign(m,n,G,d,k)#第六问
d2=Schnorr_and_ECDSA(r,s,r3,s3,m,n)
print("破解是否成功：")
print(d == d2)
print("#------------------------------------------------------------#")
#——————————————————————————————————————————test_VERSION 1.2—————————————————————————————————————————————#
#—————————————————————————————————————————————End...—————————————————————————————————————————————#
